<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <!-- UI Extensions CSS -->
  <link rel="stylesheet" href="https://contentful.github.io/ui-extensions-sdk/cf-extension.css">
  <link rel="stylesheet" href="https://unpkg.com/contentful-ui-extensions-sdk@3.11.0/dist/cf-extension.css">

  <!-- UI Extensions SDK -->
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://unpkg.com/contentful-ui-extensions-sdk@3"></script>
</head>

<body>

  <div id="app">
    <label v-if="showSelectedPlayers"
      style="display: inline-block; color: #2a3039; font-weight: 600; margin-bottom: .5rem;">Players</label>
    <ul v-if="showSelectedPlayers" style="list-style: none; display: block; padding: 0;">
      <li v-for="item in selectedPlayers" v-bind:id="item.id"
        style="display: inline-block; margin-right: 15px; cursor: pointer;" @click="removeSelectedPlayer(item)">
        <div
          style="color: #808080; font-size: 13px; max-width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
          {{item.name}} &times;</div>
      </li>
    </ul>
    <div class="cf-form-field">
      <input type="text" class="cf-form-input" v-model.trim="query" v-on:keyup="search()">
      <div class="cf-form-hint">Search by name of athlete</div>
    </div>
    <div class="cf-form-field">
      <!--
      <label v-if="showSuggestions" style="display: inline-block;
      color: #2a3039;
      font-weight: 600;
      margin-bottom: .5rem;">Suggestions</label>-->
      <ul v-if="showSuggestions" style="list-style: none; display: block; padding: 0;">
        <li v-for="item in suggestions" v-bind:id="item.id"
          style="display: inline-block; margin-right: 15px; cursor: pointer;" @click="selectPlayer(item)">
          <div><img :src="item.imgUrl" style="border-radius: 8px;" /></div>
          <div
            style="color: #808080; font-size: 13px; max-width: 120px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
            {{item.name}}</div>
        </li>
      </ul>

    </div>
  </div>




  <!-- Custom markup of the UI Extension 
  <div class="cf-form-field">
    <input type="text" class="cf-form-input">
    <div class="cf-form-hint">I am a custom UI Extension!</div>
    <div class="cf-form-hint">Instance params: <span class="instance-param-value"></span></div>
    <div class="cf-form-hint">Installation params: <span class="installation-param-value"></span></div>
  </div>
  -->
  <!-- Custom logic of the UI Extension -->
  <script>
    'use strict';

    // When UI Extensions SDK is loaded the callback will be executed.
    window.contentfulExtension.init(initExtension);

    function initExtension(extensionsApi) {
      // "extensionsApi" is providing an interface documented here:
      // https://github.com/contentful/ui-extensions-sdk/blob/master/docs/ui-extensions-sdk-frontend.md

      // Automatically adjust UI Extension size in the Web App.
      extensionsApi.window.startAutoResizer();

      var inputEl = document.querySelector('.cf-form-input');

      //  The field this UI Extension is assigned to.
      var field = extensionsApi.field;

      document.querySelector('.instance-param-value').appendChild(document.createTextNode(extensionsApi.parameters.instance.exampleParameter))
      document.querySelector('.installation-param-value').appendChild(document.createTextNode(extensionsApi.parameters.installation.exampleParameter))


      // Callback for changes of the field value.
      var detachValueChangeHandler = field.onValueChanged(valueChangeHandler);
      // Handle keyboard input.
      inputEl.addEventListener('input', keyboardInputHandler);
      // Handle DOM "onbeforeunload" event.
      window.addEventListener('onbeforeunload', unloadHandler);

      // Handler for external field value changes (e.g. when multiple authors are working on the same entry).
      function valueChangeHandler(value) {
        inputEl.value = value || '';
      }

      // Event handler for keyboard input.
      function keyboardInputHandler() {
        var value = inputEl.value;
        if (typeof value !== 'string' || value === '') {
          field.removeValue();
        } else {
          field.setValue(value);
        }
      }

      // Event handler for window unload.
      function unloadHandler() {
        window.removeEventListener('onbeforeunload', unloadHandler);
        inputEl.removeEventListener('input', keyboardInputHandler);
        detachValueChangeHandler();
      }
    }
  </script>
  <script src="main.js"></script>
</body>

</html>